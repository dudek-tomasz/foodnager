---
/**
 * Profile Page
 *
 * User profile page displaying account information and logout option.
 * Following auth-spec.md and PRD US-001.6:
 * - Protected route (requires authentication)
 * - Shows user email and account creation date
 * - Logout button for mobile users
 * - Desktop users can logout from Sidebar
 *
 * MVP: Simple profile without statistics or avatar upload
 */

import Layout from "@/layouts/Layout.astro";
import ProfileView from "@/components/profile/ProfileView";

export const prerender = false;

// Get user from middleware (required for protected route)
const user = Astro.locals.user;

// If not authenticated, redirect to login
// Middleware already handles this, but double-check
if (!user) {
  return Astro.redirect("/login");
}

// Prepare user data for ProfileView
const userData = {
  id: user.id,
  email: user.email,
  createdAt: Astro.locals.session?.user?.created_at || new Date().toISOString(),
};
---

<Layout title="Profil - Foodnager">
  <ProfileView client:load user={userData} />
</Layout>
